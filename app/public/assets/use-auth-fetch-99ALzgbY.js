import{c as le,K as ce,a3 as ue,m as W,n as se,d as fe,a4 as de,a5 as he,a as A,W as pe,s as me,L as ye,w as be,u as Fe,a6 as ge,a7 as G,a8 as ve,r as N,a9 as Te,aa as we,k as L,x as oe,O as re,ab as Q,ac as Pe}from"./index-CnDVkyK8.js";const[Oe,j]=le("button"),Ee=ce({},ue,{tag:W("button"),text:String,icon:String,type:W("default"),size:W("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:W("button"),loadingSize:se,loadingText:String,loadingType:String,iconPosition:W("left")});var Se=fe({name:Oe,props:Ee,emits:["click"],setup(e,{emit:t,slots:n}){const c=de(),l=()=>n.loading?n.loading():A(ye,{size:e.loadingSize,type:e.loadingType,class:j("loading")},null),a=()=>{if(e.loading)return l();if(n.icon)return A("div",{class:j("icon")},[n.icon()]);if(e.icon)return A(pe,{name:e.icon,class:j("icon"),classPrefix:e.iconPrefix},null)},o=()=>{let i;if(e.loading?i=e.loadingText:i=n.default?n.default():e.text,i)return A("span",{class:j("text")},[i])},F=()=>{const{color:i,plain:h}=e;if(i){const r={color:h?i:"white"};return h||(r.background=i),i.includes("gradient")?r.border=0:r.borderColor=i,r}},f=i=>{e.loading?me(i):e.disabled||(t("click",i),c())};return()=>{const{tag:i,type:h,size:r,block:u,round:p,plain:d,square:T,loading:y,disabled:b,hairline:w,nativeType:g,iconPosition:v}=e,P=[j([h,r,{plain:d,block:u,round:p,square:T,loading:y,disabled:b,hairline:w}]),{[he]:w}];return A(i,{type:g,class:P,style:F(),disabled:b,onClick:f},{default:()=>[A("div",{class:j("content")},[v==="left"&&a(),o(),v==="right"&&a()])]})}}});const He=be(Se);function ae(e){return Te()?(we(e),!0):!1}function X(){const e=new Set,t=l=>{e.delete(l)};return{on:l=>{e.add(l);const a=()=>t(l);return ae(a),{off:a}},off:t,trigger:(...l)=>Promise.all(Array.from(e).map(a=>a(...l)))}}function E(e){return typeof e=="function"?e():Fe(e)}const ie=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Be=()=>{};function ne(e,t=!1,n="Timeout"){return new Promise((c,l)=>{setTimeout(t?()=>l(n):c,e)})}function xe(e,...t){return t.some(n=>n in e)}function Y(...e){if(e.length!==1)return ge(...e);const t=e[0];return typeof t=="function"?G(ve(()=>({get:t,set:Be}))):N(t)}function Z(e,t=!1){function n(r,{flush:u="sync",deep:p=!1,timeout:d,throwOnTimeout:T}={}){let y=null;const w=[new Promise(g=>{y=L(e,v=>{r(v)!==t&&(y==null||y(),g(v))},{flush:u,deep:p,immediate:!0})})];return d!=null&&w.push(ne(d,T).then(()=>E(e)).finally(()=>y==null?void 0:y())),Promise.race(w)}function c(r,u){if(!oe(r))return n(v=>v===r,u);const{flush:p="sync",deep:d=!1,timeout:T,throwOnTimeout:y}=u??{};let b=null;const g=[new Promise(v=>{b=L([e,r],([P,x])=>{t!==(P===x)&&(b==null||b(),v(P))},{flush:p,deep:d,immediate:!0})})];return T!=null&&g.push(ne(T,y).then(()=>E(e)).finally(()=>(b==null||b(),E(e)))),Promise.race(g)}function l(r){return n(u=>!!u,r)}function a(r){return c(null,r)}function o(r){return c(void 0,r)}function F(r){return n(Number.isNaN,r)}function f(r,u){return n(p=>{const d=Array.from(p);return d.includes(r)||d.includes(E(r))},u)}function i(r){return h(1,r)}function h(r=1,u){let p=-1;return n(()=>(p+=1,p>=r),u)}return Array.isArray(E(e))?{toMatch:n,toContains:f,changed:i,changedTimes:h,get not(){return Z(e,!t)}}:{toMatch:n,toBe:c,toBeTruthy:l,toBeNull:a,toBeNaN:F,toBeUndefined:o,changed:i,changedTimes:h,get not(){return Z(e,!t)}}}function De(e){return Z(e)}function Ce(e,t,n={}){const{immediate:c=!0}=n,l=N(!1);let a=null;function o(){a&&(clearTimeout(a),a=null)}function F(){l.value=!1,o()}function f(...i){o(),l.value=!0,a=setTimeout(()=>{l.value=!1,a=null,e(...i)},E(t))}return c&&(l.value=!0,ie&&f()),ae(F),{isPending:G(l),start:f,stop:F}}const ke=ie?window:void 0,Ae={json:"application/json",text:"text/plain"};function M(e){return e&&xe(e,"immediate","refetch","initialData","timeout","beforeFetch","afterFetch","onFetchError","fetch","updateDataOnError")}function je(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function I(e){return typeof Headers<"u"&&e instanceof Headers?Object.fromEntries(e.entries()):e}function U(e,...t){return e==="overwrite"?async n=>{const c=t[t.length-1];return c?{...n,...await c(n)}:n}:async n=>{for(const c of t)c&&(n={...n,...await c(n)});return n}}function Ue(e={}){const t=e.combination||"chain",n=e.options||{},c=e.fetchOptions||{};function l(a,...o){const F=re(()=>{const h=E(e.baseUrl),r=E(a);return h&&!je(r)?_e(h,r):r});let f=n,i=c;return o.length>0&&(M(o[0])?f={...f,...o[0],beforeFetch:U(t,n.beforeFetch,o[0].beforeFetch),afterFetch:U(t,n.afterFetch,o[0].afterFetch),onFetchError:U(t,n.onFetchError,o[0].onFetchError)}:i={...i,...o[0],headers:{...I(i.headers)||{},...I(o[0].headers)||{}}}),o.length>1&&M(o[1])&&(f={...f,...o[1],beforeFetch:U(t,n.beforeFetch,o[1].beforeFetch),afterFetch:U(t,n.afterFetch,o[1].afterFetch),onFetchError:U(t,n.onFetchError,o[1].onFetchError)}),Ne(F,i,f)}return l}function Ne(e,...t){var n;const c=typeof AbortController=="function";let l={},a={immediate:!0,refetch:!1,timeout:0,updateDataOnError:!1};const o={method:"GET",type:"text",payload:void 0};t.length>0&&(M(t[0])?a={...a,...t[0]}:l=t[0]),t.length>1&&M(t[1])&&(a={...a,...t[1]});const{fetch:F=(n=ke)==null?void 0:n.fetch,initialData:f,timeout:i}=a,h=X(),r=X(),u=X(),p=N(!1),d=N(!1),T=N(!1),y=N(null),b=Q(null),w=Q(null),g=Q(f||null),v=re(()=>c&&d.value);let P,x;const q=()=>{c&&(P==null||P.abort(),P=new AbortController,P.signal.onabort=()=>T.value=!0,l={...l,signal:P.signal})},V=m=>{d.value=m,p.value=!m};i&&(x=Ce(q,i,{immediate:!1}));let J=0;const R=async(m=!1)=>{var O,S;q(),V(!0),w.value=null,y.value=null,T.value=!1,J+=1;const z=J,C={method:o.method,headers:{}};if(o.payload){const s=I(C.headers),B=E(o.payload);!o.payloadType&&B&&Object.getPrototypeOf(B)===Object.prototype&&!(B instanceof FormData)&&(o.payloadType="json"),o.payloadType&&(s["Content-Type"]=(O=Ae[o.payloadType])!=null?O:o.payloadType),C.body=o.payloadType==="json"?JSON.stringify(B):B}let te=!1;const H={url:E(e),options:{...C,...l},cancel:()=>{te=!0}};if(a.beforeFetch&&Object.assign(H,await a.beforeFetch(H)),te||!F)return V(!1),Promise.resolve(null);let k=null;return x&&x.start(),F(H.url,{...C,...H.options,headers:{...I(C.headers),...I((S=H.options)==null?void 0:S.headers)}}).then(async s=>{if(b.value=s,y.value=s.status,k=await s.clone()[o.type](),!s.ok)throw g.value=f||null,new Error(s.statusText);return a.afterFetch&&({data:k}=await a.afterFetch({data:k,response:s})),g.value=k,h.trigger(s),s}).catch(async s=>{let B=s.message||s.name;if(a.onFetchError&&({error:B,data:k}=await a.onFetchError({data:k,error:s,response:b.value})),w.value=B,a.updateDataOnError&&(g.value=k),r.trigger(s),m)throw s;return null}).finally(()=>{z===J&&V(!1),x&&x.stop(),u.trigger(null)})},ee=Y(a.refetch);L([ee,Y(e)],([m])=>m&&R(),{deep:!0});const $={isFinished:G(p),isFetching:G(d),statusCode:y,response:b,error:w,data:g,canAbort:v,aborted:T,abort:q,execute:R,onFetchResponse:h.on,onFetchError:r.on,onFetchFinally:u.on,get:D("GET"),put:D("PUT"),post:D("POST"),delete:D("DELETE"),patch:D("PATCH"),head:D("HEAD"),options:D("OPTIONS"),json:_("json"),text:_("text"),blob:_("blob"),arrayBuffer:_("arrayBuffer"),formData:_("formData")};function D(m){return(O,S)=>{if(!d.value)return o.method=m,o.payload=O,o.payloadType=S,oe(o.payload)&&L([ee,Y(o.payload)],([z])=>z&&R(),{deep:!0}),{...$,then(z,C){return K().then(z,C)}}}}function K(){return new Promise((m,O)=>{De(p).toBe(!0).then(()=>m($)).catch(S=>O(S))})}function _(m){return()=>{if(!d.value)return o.type=m,{...$,then(O,S){return K().then(O,S)}}}}return a.immediate&&Promise.resolve().then(()=>R()),{...$,then(m,O){return K().then(m,O)}}}function _e(e,t){return!e.endsWith("/")&&!t.startsWith("/")?`${e}/${t}`:`${e}${t}`}const We=Ue({combination:"overwrite",options:{async beforeFetch({options:e}){return e.headers={...e.headers,...Pe.value},{options:e}}}});export{He as B,We as u};
